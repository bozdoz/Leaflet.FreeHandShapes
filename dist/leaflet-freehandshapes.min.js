!function t(i,e,n){function o(a,r){if(!e[a]){if(!i[a]){var h="function"==typeof require&&require;if(!r&&h)return h(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=e[a]={exports:{}};i[a][0].call(d.exports,function(t){var e=i[a][1][t];return o(e?e:t)},d,d.exports,t,i,e,n)}return e[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,i,e){function n(){}n.prototype={map:null,setMap:function(t){this.map=t},brian3kbGrahamScan:function(t){var i=new ConvexHullGrahamScan,e=[],n=[],o=[];t.forEach(function(t){n.push(this.map.latLngToLayerPoint(t))}.bind(this)),n.forEach(function(t){i.addPoint(t.x,t.y)}.bind(this));var s=i.getHull();return s.forEach(function(t){e.push(L.point(t.x,t.y))}.bind(this)),e.push(e[0]),e.forEach(function(t){o.push(this.map.layerPointToLatLng(t))}.bind(this)),o},wildhoneyConcaveHull:function(t){return t.push(t[0]),new ConcaveHull(t).getLatLngs()}},"object"==typeof i&&"object"==typeof i.exports&&(i.exports=n)},{}],2:[function(t,i,e){function n(){}n.prototype={states:[[]],current:0,save:function(t){this.current++,this.states[this.current]&&this.clearFrom(this.current),this.states[this.current]||(this.states[this.current]=[]),t.forEach(function(t){this.states[this.current].push(t._latlngs)}.bind(this))},undo:function(){return this.current--,this.states[this.current]||this.current++,this.states[this.current]},canUndo:function(){return!!this.states[this.current-1]},redo:function(){return this.current++,this.states[this.current]||this.current--,this.states[this.current]},canRedo:function(){return!!this.states[this.current+1]},clearFrom:function(t){this.states.splice(t)}},"object"==typeof i&&"object"==typeof i.exports&&(i.exports=n)},{}],3:[function(t,i,e){var n=t("./Memory"),o=t("./Hull");L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this)},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd)},_onTouchStart:function(t){if(this._map._loaded){var i="touchstart",e=t.touches[0],n=this._container.getBoundingClientRect(),o=e.clientX-n.left-this._container.clientLeft,s=e.clientY-n.top-this._container.clientTop,a=L.point(o,s),r=this._map.containerPointToLayerPoint(a);latlng=this._map.containerPointToLatLng(a),this._map.fire(i,{latlng:latlng,layerPoint:r,containerPoint:a,originalEvent:t})}},_onTouchMove:function(t){if(this._map._loaded&&t.changedTouches.length){var i="touchmove",e=t.changedTouches[0],n=this._container.getBoundingClientRect(),o=e.clientX-n.left-this._container.clientLeft,s=e.clientY-n.top-this._container.clientTop,a=L.point(o,s),r=this._map.containerPointToLayerPoint(a);latlng=this._map.containerPointToLatLng(a),this._map.fire(i,{latlng:latlng,layerPoint:r,containerPoint:a,originalEvent:t})}},_onTouchEnd:function(t){if(this._map._loaded){var i="touchend";this._map.fire(i,{originalEvent:t})}}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.FreeHandShapes=L.FeatureGroup.extend({statics:{RECOUNT_TIMEOUT:1},options:{polygon:{className:"leaflet-free-hand-shapes",smoothFactor:5},multiplePolygons:!0,simplifyPolygon:!0,invalidLength:3,hullAlgorithm:"wildhoneyConcaveHull",boundariesAfterEdit:!1,createExitMode:!0,attemptMerge:!0,iconClassName:"polygon-elbow",svgClassName:"tracer",polygonClassName:"tracer",deleteExitMode:!1,memoriseEachEdge:!0,destroyPrevious:!1,disablePropagation:!1,elbowDistance:10,onlyInDistance:!1},initialize:function(t){return"undefined"==typeof d3?void console.error("D3 is a required library","http://d3js.org/"):"undefined"==typeof ClipperLib?void console.error("JSClipper is a required library","http://sourceforge.net/p/jsclipper/wiki/Home%206/"):(L.Util.setOptions(this,t),this.fromPoint={x:0,y:0},this.polygons=[],this.edges=[],this._latLngs=[],this.memory=new n,this.hull=new o,this.element=t.element||null,this.setMode(t.mode||1),void(this.Polygon=L.Polygon.extend({options:this.options.polygon})))},onAdd:function(t){this.map=t,this.mode=this.mode||L.FreeHandShapes.MODES.VIEW,this.defaultPreferences={dragging:t.dragging._enabled,touchZoom:t.touchZoom._enabled,doubleClickZoom:t.doubleClickZoom._enabled,scrollWheelZoom:t.scrollWheelZoom._enabled},this.element||(this.element=t._container),this.lineFunction=d3.line().x(function(t){return t.x}).y(function(t){return t.y}),this.d3elem=d3.select(this.options.element||this.element),this.createD3(),this.map.on("mousedown touchstart",this.mouseDown,this),this.map.on("mousemove touchmove",this.mouseMove,this),this.map.on("mouseup touchend",this.mouseUpLeave,this),document.body.addEventListener("mouseleave",this.mouseUpLeave.bind(this)),this.d3map=d3.select(this.map._container),this.setMode(this.mode)},onRemove:function(){this._clearPolygons(),this.map.off("mousedown touchstart",this.bindEvents().mouseDown),this.map.off("mousemove touchmove",this.bindEvents().mouseMove),this.map.off("mousedown touchstart",this.bindEvents().mouseUpLeave);var t=window.document.getElementsByTagName("body")[0];t.removeEventListener("mouseleave",this.bindEvents().mouseUpLeave)},recreateEdges:function(t){return this.edges=this.edges.filter(function(i){return i._freedraw.polygon!==t||void this.map.removeLayer(i)}.bind(this)),this.createEdges(t)},resurrectOrphans:function(){var t=function(t){setTimeout(function(){this.silently(function(){this.recreateEdges(t)}.bind(this))}.bind(this))},i=this.getPolygons(!0);i.forEach(function(i){i&&i._parts[0]&&t.call(this,i)}.bind(this)),setTimeout(function(){this.notifyBoundaries()}.bind(this))},silently:function(t){var i=this.silenced;this.silenced=!0,t.apply(this),i||(this.silenced=!1)},cancelAction:function(){this.creating=!1,this.movingEdge=null,this.destroyD3().createD3()},setMapPermissions:function(t){this.map.dragging[t](),this.map.touchZoom[t](),this.map.doubleClickZoom[t](),this.map.scrollWheelZoom[t](),"enable"===t&&(this.defaultPreferences.dragging||this.map.dragging.disable(),this.defaultPreferences.touchZoom||this.map.touchZoom.disable(),this.defaultPreferences.doubleClickZoom||this.map.doubleClickZoom.disable(),this.defaultPreferences.scrollWheelZoom||this.map.scrollWheelZoom.disable())},setMode:function(t){if(t=0===t?L.FreeHandShapes.MODES.VIEW:t,this.mode=t,this.fire("mode",{mode:t}),this.map){var i=!!(t&L.FreeHandShapes.MODES.CREATE),e=i?"disable":"enable";this.map.dragging[e](),!this.boundaryUpdateRequired||this.mode&L.FreeHandShapes.MODES.EDIT||(this.notifyBoundaries(),this.boundaryUpdateRequired=!1,this.options.memoriseEachEdge||this.memory.save(this.getPolygons(!0))),function(i,e,n,o){o(e,"mode-create"),o(e,"mode-edit"),o(e,"mode-delete"),o(e,"mode-view"),o(e,"mode-append"),t&i.CREATE&&n(e,"mode-create"),t&i.EDIT&&n(e,"mode-edit"),t&i.DELETE&&n(e,"mode-delete"),t&i.VIEW&&n(e,"mode-view"),t&i.APPEND&&n(e,"mode-append")}(L.FreeHandShapes.MODES,this.map._container,L.DomUtil.addClass,L.DomUtil.removeClass)}},unsetMode:function(t){this.setMode(this.mode^t)},createD3:function(){this.svg=this.d3elem.append("svg").attr("class",this.options.svgClassName).attr("width",200).attr("height",200)},destroyD3:function(){return this.svg.remove(),this.svg={},this},latLngsToClipperPoints:function(t){return t.map(function(t){var i=this.map.latLngToLayerPoint(t);return{X:i.x,Y:i.y}}.bind(this))},clipperPolygonsToLatLngs:function(t){var i=[];return t.forEach(function(t){t.forEach(function(t){t=L.point(t.X,t.Y);var e=this.map.layerPointToLatLng(t);i.push(e)}.bind(this))}.bind(this)),i},uniqueLatLngs:function(t){var i=[],e=[];return t.forEach(function(t){var n=JSON.stringify(t);i.indexOf(n)===-1&&(i.push(n),e.push(t))}),e},handlePolygonClick:function(t,i){var e=[],n=this.map.mouseEventToContainerPoint(i.originalEvent),o=1/0,s=new L.Point,a=new L.Point,r=[];t._latlngs.forEach(function(t){r.push(this.map.latLngToContainerPoint(t))}.bind(this)),r.forEach(function(t,i){var e=t,h=r[i+1]||r[0],l=L.LineUtil.pointToSegmentDistance(n,e,h);l<o&&(o=l,s=e,a=h)}.bind(this)),r.forEach(function(t,i){var o=r[i+1]||r[0];return t===s&&o===a?(e.push(this.map.containerPointToLatLng(t)),void e.push(this.map.containerPointToLatLng(n))):void e.push(this.map.containerPointToLatLng(t))}.bind(this));var h=this.options.elbowDistance,l=function(){this.mode&L.FreeHandShapes.MODES.APPEND&&(t.setLatLngs(e),this.destroyEdges(t),this.createEdges(t))}.bind(this);if(this.mode&L.FreeHandShapes.MODES.APPEND&&!(this.mode&L.FreeHandShapes.MODES.DELETE)){if(this.options.onlyInDistance&&o>h)return;return void l()}return this.mode&L.FreeHandShapes.MODES.DELETE&&!(this.mode&L.FreeHandShapes.MODES.APPEND)?void this.destroyPolygon(t):o>h&&this.mode&L.FreeHandShapes.MODES.DELETE?void this.destroyPolygon(t):void l()},createPolygon:function(t,i){if(!this.options.multiplePolygons&&this.getPolygons(!0).length>=1){if(!this.options.destroyPrevious)return this.destroyD3().createD3(),!1;this.silently(this.clearPolygons)}if(this.destroyD3().createD3(),this.options.simplifyPolygon&&(t=function(){var i=ClipperLib.Clipper.CleanPolygon(this.latLngsToClipperPoints(t),1.1),e=ClipperLib.Clipper.SimplifyPolygon(i,ClipperLib.PolyFillType.pftNonZero);return this.clipperPolygonsToLatLngs(e)}.apply(this)),t.length<=this.options.invalidLength&&!i)return!1;var e=new this.Polygon(t);return e.on("click",function(t){this.handlePolygonClick(e,t)}.bind(this)),e.addTo(this.map),this.polygons.push(e),this.createEdges(e),function(){!this.silenced&&e._parts[0]&&(e._latlngs=[],e._parts[0].forEach(function(t){e._latlngs.push(this.map.layerPointToLatLng(t))}.bind(this)))}.bind(this)(),this.options.attemptMerge&&!this.silenced&&this.mergePolygons(),this.silenced||(this.notifyBoundaries(),this.memory.save(this.getPolygons(!0))),e},predefinedPolygon:function(t){return this.createPolygon(t,!0)},undo:function(){this._modifyState("undo")},redo:function(){this._modifyState("redo")},_modifyState:function(t){this.silently(this._clearPolygons.bind(this));var i=this.memory[t]();i.forEach(function(t){this.silently(function(){this.createPolygon(t)}.bind(this))}.bind(this)),this.notifyBoundaries()},getPolygons:function(t){var i=[];if(t){if(!this.map)return[];var e="G";for(var n in this.map._layers)if(this.map._layers.hasOwnProperty(n)){var o=this.map._layers[n];o._container&&o._container.tagName.toUpperCase()===e&&o instanceof this.Polygon&&i.push(o)}}else this.edges.forEach(function(t){i.indexOf(t._freedraw.polygon)===-1&&t._freedraw.polygon instanceof this.Polygon&&i.push(t._freedraw.polygon)}.bind(this));return i},mergePolygons:function(){var t=function(){var t=this.getPolygons(),i=[];t.forEach(function(t){i.push(this.latLngsToClipperPoints(t._latlngs))}.bind(this));var e=ClipperLib.Clipper.SimplifyPolygons(i,ClipperLib.PolyFillType.pftNonZero);this.silently(function(){this._clearPolygons(),e.forEach(function(t){var i=[];t.forEach(function(t){t=L.point(t.X,t.Y),i.push(this.map.layerPointToLatLng(t))}.bind(this)),this.createPolygon(i,!0)}.bind(this))})}.bind(this);t(),t(),this.getPolygons(!0).forEach(this.trimPolygonEdges.bind(this))},destroyPolygon:function(t){this.map.removeLayer(t);var i=this.polygons.indexOf(t);this.polygons.splice(i,1),this.destroyEdges(t),this.silenced||(this.notifyBoundaries(),this.memory.save(this.getPolygons(!0))),this.options.deleteExitMode&&!this.silenced&&this.setMode(this.mode^L.FreeHandShapes.MODES.DELETE)},destroyEdges:function(t){this.edges=this.edges.filter(function(i){return i._freedraw.polygon!==t||void this.map.removeLayer(i)}.bind(this))},clearPolygons:function(){this.silently(this._clearPolygons),this.silenced||(this.notifyBoundaries(),this.memory.save(this.getPolygons(!0)))},_clearPolygons:function(){this.getPolygons().forEach(function(t){this.destroyPolygon(t)}.bind(this)),this.silenced||this.notifyBoundaries()},notifyBoundaries:function(){var t=[];this.getPolygons(!0).forEach(function(i){t.push(i._latlngs)}.bind(this)),function(){t.forEach(function(t){var i=t.length-1;if(i&&t[0]&&t[i]){var e=t[0].lat!==t[i].lat,n=t[0].lng!==t[i].lng;(e||n)&&t.push(t[0])}})}.bind(this)(),this.polygonCount=t.length;var i=JSON.stringify(t);this.lastNotification!==i&&(this.lastNotification=i,this.fire("markers",{latLngs:t}),setTimeout(this.emitPolygonCount.bind(this),L.FreeHandShapes.RECOUNT_TIMEOUT))},emitPolygonCount:function(){var t="M0 0",i=this.getPolygons(!0),e=i.every(function(i){var e=i._container.lastChild.getAttribute("d").trim();return e===t});e&&(this.silently(function(){this._clearPolygons(),this.fire("markers",{latLngs:[]}),this.fire("count",{count:this.polygonCount})}.bind(this)),this.polygonCount=0,i.length=0),i.length!==this.polygonCount&&(this.polygonCount=i.length,this.fire("count",{count:this.polygonCount}))},createEdges:function(t){var i=function(t){return t._parts[0]?t._latlngs.map(function(t){return this.map.latLngToLayerPoint(t)}.bind(this)):[]}.bind(this),e=this.uniqueLatLngs(i(t)),n=this.polygons.indexOf(t),o=0;return!!e&&(e.forEach(function(i){var e=new L.DivIcon({className:Array.isArray(this.options.iconClassName)?this.options.iconClassName[n]:this.options.iconClassName}),s=this.map.layerPointToLatLng(i);e=L.marker(s,{icon:e}).addTo(this.map),e._freedraw={polygon:t,polygonId:t._leaflet_id,latLng:e._latlng},this.edges.push(e),o++,e.on("mousedown touchstart",function(t){t.originalEvent.preventDefault(),t.originalEvent.stopPropagation(),this.movingEdge=t.target}.bind(this))}.bind(this)),o)},updatePolygonEdge:function(t,i,e){var n=this.map.containerPointToLatLng(new L.Point(i,e));t.setLatLng(n),t._freedraw.latLng=n;var o=[],s=this.edges.filter(function(i){return o.push(i),i._freedraw.polygon===t._freedraw.polygon});this.edges=o;var a=[];s.forEach(function(t){a.push(t.getLatLng())}),t._freedraw.polygon.setLatLngs(a),t._freedraw.polygon.redraw()},mouseDown:function(t){if(!this.creating){var i=2;if(t.originalEvent.button!==i){var e=t.originalEvent;this.options.disablePropagation||e.stopPropagation(),e.preventDefault(),this.latLngs=[],this.fromPoint=this.map.latLngToContainerPoint(t.latlng),this.mode&L.FreeHandShapes.MODES.CREATE&&(this.creating=!0,this.setMapPermissions("disable"))}}},mouseMove:function(t){if(this.movingEdge)return void this._editMouseMove(t);if(this.creating){var i=t.latlng,e=this.map.latLngToContainerPoint(i),n=[this.fromPoint,e];this.svg.append("path").classed("drawing-line",!0).attr("d",this.lineFunction(n)).attr("stroke","#D7217E").attr("stroke-width",2).attr("fill","none"),this.fromPoint=e,this.latLngs.push(i)}},mouseUpLeave:function(){return this.movingEdge?(this.options.boundariesAfterEdit?this.boundaryUpdateRequired=!0:this.notifyBoundaries(),this.trimPolygonEdges(this.movingEdge._freedraw.polygon),this.mergePolygons(),this.movingEdge=null,this.options.memoriseEachEdge&&this.memory.save(this.getPolygons(!0)),void setTimeout(this.emitPolygonCount.bind(this),L.FreeHandShapes.RECOUNT_TIMEOUT)):void this._createMouseUp()},_editMouseMove:function(t){var i=this.map.latLngToContainerPoint(t.latlng),e=this.movingEdge._icon.style;e[L.DomUtil.TRANSFORM]=i,this.updatePolygonEdge(this.movingEdge,i.x,i.y)},touchStart:function(t){this.creating||(this.options.disablePropagation||d3.event.stopPropagation(),d3.event.preventDefault(),this.latLngs=[],this.fromPoint=L.point(t),this.mode&L.FreeHandShapes.MODES.CREATE&&(this.creating=!0,this.setMapPermissions("disable")))},touchMove:function(t){if(this.movingEdge)return void this._editMouseMove(event);if(this.creating){var i=L.point(t),e=this.map.containerPointToLatLng(i),n=[this.fromPoint,i];this.svg.append("path").classed("drawing-line",!0).attr("d",this.lineFunction(n)).attr("stroke","#D7217E").attr("stroke-width",2).attr("fill","none"),this.fromPoint=i,this.latLngs.push(e)}},trimPolygonEdges:function(t){var i=[];t&&0!==t._parts.length&&t._parts[0]&&(t._parts[0].forEach(function(t){i.push(this.map.layerPointToLatLng(t))}.bind(this)),t.setLatLngs(i),t.redraw(),this.destroyEdges(t),this.createEdges(t))},_createMouseUp:function(){if(this.creating&&(this.creating=!1,!(this.latLngs.length<=2))){if(this.options.hullAlgorithm){this.hull.setMap(this.map);var t=this.hull[this.options.hullAlgorithm](this.latLngs)}this.latLngs.push(this.latLngs[0]);var i=this.createPolygon(t||this.latLngs);if(!i)return void this.setMapPermissions("enable");this.latLngs=[],this.options.createExitMode&&this.setMode(this.mode^L.FreeHandShapes.MODES.CREATE),this.setMapPermissions("enable")}}}),L.FreeHandShapes.MODES={NONE:0,VIEW:1,CREATE:2,EDIT:4,DELETE:8,APPEND:16,EDIT_APPEND:20,ALL:31}},{"./Hull":1,"./Memory":2}]},{},[3]);